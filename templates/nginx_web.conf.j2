upstream node_mgr_server{
    server                  {{ webase_web.nginx.node_manager }}; # 节点管理服务ip和端口
}

server {
    listen                  {{ webase_web.nginx.port }} default_server; # 前端端口（端口需要开通策略且不能被占用）
    server_name             {{ webase_web.nginx.domain | default('127.0.0.1') }};           # 服务器ip，也可配置为域名

    location / {
        root                /opt/www/WeBASE-Web;   # 前端文件路径(文件需要有权限访问)
        index               index.html index.htm;
        try_files           $uri $uri/ /index.html =404;
    }

    location /static {
        root                /opt/www/WeBASE-Web;   # 前端文件路径(文件需要有权限访问)
        autoindex           on;
    }

    include /etc/nginx/default.d/*.conf;

    location /mgr {
        proxy_pass          http://node_mgr_server/;
        proxy_set_header		Host			       $host;
        proxy_set_header		X-Real-IP		     $remote_addr;
        proxy_set_header		X-Forwarded-For	 $proxy_add_x_forwarded_for;
    }
}
